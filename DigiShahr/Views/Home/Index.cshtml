@model DataLayer.ViewModel.IndexViewModel
@{
    ViewData["Title"] = "خانه";
    Layout = "~/Views/Shared/_UserLayout.cshtml";
}

@*<h3>Index</h3>*@
<link href="~/StyleCenter/Sass/Home/Home.min.css" rel="stylesheet" />
<link href="~/StyleCenter/Sass/LoginRegister/BodyStyle.min.css" rel="stylesheet" />

<div class="index" id="index">
    <div class="IndexContainer">
        <div id="map" class="map"></div>
        <div id="search" class="Search center">

            <div class="center">

                <form class="uk-search uk-search-default uk-margin-left">
                    <a href="" uk-search-icon></a>
                    <input class="center uk-search-input" type="search" placeholder="جستجو">
                </form>
                <a id="Location"><span class="icon-holder uk-margin-left" uk-icon="locate"></span></a>
            </div>

        </div>
    </div>
    <div class="MenuGrid grid uk-padding-small center uk-child-width-1-3" uk-grid dir="rtl" id="MenuGrid">
        <a class="mat category" href="#modal" uk-toggle> هایپر مارکت </a>
        <a class="mat category" href="#modal" uk-toggle> هایپر مارکت </a>
        <a class="mat category" href="#modal" uk-toggle> هایپر مارکت </a>
        <a class="mat category" href="#modal" uk-toggle> هایپر مارکت </a>
        <a class="mat category" href="#modal" uk-toggle> هایپر مارکت </a>
        <a class="mat category" href="#modal" uk-toggle> هایپر مارکت </a>
    </div>




</div>
@*<div class="my-clipped uk-padding-small PopUpContent" dir="rtl">
        <div class="my-row">
            <img src="~/img/Store/logo-defult.png" width="80" height="80" />
            <div class="my-column uk-margin-right center">
                <label>نام فروشگاه</label>
                <div class="star-container" uk-tooltip="4">
                    <div class="Stars" style="--rating:4"></div>
                </div>
            </div>
        </div>
        <hr />
        <div class="my-column">
            <label><span class="icon-holder  uk-text-danger" uk-icon="location"></span> نشانی فروشگاه</label>
            <label><span class="icon-holder uk-margin-small-top gly-rotate-45" uk-icon="call-outline"></span> 09145281056</label>
        </div>
        <div class="center gradientButtonLink uk-margin-small-top">
            <a class="center ">ورود به فروشگاه</a>
        </div>
    </div>*@

<div id="modal" uk-modal>
    <div class="uk-modal-dialog uk-margin-auto-vertical subCategory" uk-overflow-auto dir="rtl">
        <button class="uk-modal-close-default" type="button" uk-close></button>
        <div class="uk-modal-header">
            <h3 class="uk-modal-title uk-text-center">انتخاب زیردسته بندی</h3>
        </div>
        <div class="uk-modal-body uk-padding-small">
            <ul uk-accordion>
                <li>
                    <a class="uk-accordion-title" href="#">سوپرمارکت</a>
                    <div class="uk-accordion-content">
                        <ul class="uk-margin-right" uk-accordion>
                            <li>
                                <a class="uk-accordion-title" href="#">زیرزیر دسته1</a>
                                <div class="uk-accordion-content">
                                    <a class="uk-margin-medium-right" onclick="Response()">فلان</a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="uk-open">
                    <a class="uk-accordion-title" href="#">پروتئینی</a>
                    <div class="uk-accordion-content">
                        <ul class="uk-margin-right" uk-accordion>
                            <li>
                                <a class="uk-accordion-title" href="#">زیرزیر دسته2</a>
                                <div class="uk-accordion-content">
                                    <a class="uk-margin-medium-right">فلان</a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
<span id="AllStore" class="hidden">
    @foreach (var item in Model.AllStore)
    {
        <span class="storeinmap">
            <logo>@item.LogoUrl</logo>
            <i>@item.Id</i>
            <n>@item.Name</n>
            <tell>@item.StaticTell</tell>
            <category>@item.Catagory.Name</category>
            <rate>@item.Rate</rate>
            <lat>@item.Lat</lat>
            <lon>@item.Lon</lon>
        </span>
    }
</span>

@section Script{

    <link href="~/leaflet/leaflet.css" rel="stylesheet" />
    <script src="~/leaflet/leaflet.js"></script>
    <script src="~/UIKit/js/uikit.min.js"></script>

    <script>

        var map = L.map('map').setView([38.07674409597339, 46.29700302496191], 11);

        L.tileLayer('https://a.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'echoville'
        }).addTo(map);


        var iconSetting = L.Icon.extend({
            options: {
                iconSize: [20, 29],
                iconAnchor: [10, 29]
            }
        });
        var customIcon = new iconSetting({ iconUrl: '/location.png' });
        var theMarker = {};

        for (var i = 0; i < $(".storeinmap").length; i++) {
            theMarker = L.marker([$(".storeinmap lat")[i].innerHTML, $(".storeinmap lon")[i].innerHTML],
                { icon: customIcon }).addTo(map).bindPopup(
                    `<div class='my-clipped PopUpContent' dir='rtl'><div class='my-row'><img src='/Upload/StoreLogo/${$(".storeinmap logo")[i].innerHTML}' width='80' height='80'/><div class= 'my-column center' ><label>${$(".storeinmap n")[i].innerHTML}</label><div class='star-container' uk-tooltip='${$(".storeinmap rate")[i].innerHTML}'><div class='Stars' style='--rating:${$(".storeinmap rate")[i].innerHTML}'></div></div></div ></div ><hr /> <div class='my-column' dir='rtl'> <label dir='rtl'><span class='icon-holder' uk-icon='file-tray-stacked-outline'></span>${$(".storeinmap category")[i].innerHTML}</label><label><span class='icon-holder uk-margin-small-top gly-rotate-45' uk-icon='call-outline'></span>${$(".storeinmap tell")[i].innerHTML}</label></div><div class='center gradientButtonLink uk-margin-small-top'><a href='Store/Piece/${$(".storeinmap i")[i].innerHTML}' class='center'>ورود به فروشگاه</a> </div> </div >`

                );
        }

        function Response() {
           document.getElementById("MenuGrid").style.display = "none";
            document.getElementById("index").style.gridTemplateRows = "1fr";
            document.getElementById("index").style.height = "calc(100vh - 110px)";
           
        }

    </script>


}
