@model IEnumerable<DataLayer.Models.TblOrder>

@using DigiShahr.Classes

<div class="card-header bg-white">
    <form action="" method="post">
        <div class="card-form row pr-1 pb-0 mb-0">
            <div class="form-inline mb-0">
                <input name="orderId" type="text" class="form-control form-control-sm mr-2" placeholder="کد سفارش">
                <input name="phoneNumber" type="tel" class="form-control form-control-sm mr-2 mt-2 mt-sm-0 " placeholder="شماره تماس">
            </div>
            <div class="form-group mx-sm-2 mr-2 mb-0">
                <input name="fromDate" type="date" class="form-control form-control-sm mb-2 mt-2" placeholder="از تاریخ">
                <input name="toDate" type="date" class="form-control form-control-sm" placeholder="تا تاریخ">
            </div>
            <div class="form-toolbar pr-2 mb-0 ">
                <button type="submit" class="btn btn-primary btn-sm mt-4">جستجو</button>
                <img id="SearchLoad" src="~/img/adminStatic/load2.gif" class="justify-content-center d-none" width="60" height="60" />
            </div>
        </div>
    </form>
</div>

<div id="card-table" class="card-body flex-div">
    <div class="table-responsive flex">
        <table class="table fixed">
            <thead class="thead-light">
                <tr>
                    <th scope="col">کد سفارش</th>
                    <th scope="col">نام مشتری</th>
                    <th scope="col">نام فروشگاه</th>
                    <th scope="col">زمان ثبت سفارش</th>
                    <th>وضعیت تایید اعتبار</th>
                    <th>وضعیت پرداخت</th>
                    <th>عملیات</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Count() == 0)
                {
                    <tr>
                        <td>یافت نشد</td>
                    </tr>
                }

                @foreach (var item in Model)
                {

                    <tr>
                        <td>#@item.Id</td>
                        <td>@item.User.Name</td>
                        <td>@item.Store.Name</td>
                        <td>@item.DateSubmited.AllToShamsi()</td>
                        @if (item.IsValid == true)
                        {
                            <td class="text-success">
                                تأیید شده
                            </td>
                        }
                        else
                        {
                            <td class="text-warning">
                                تأیید شده
                            </td>
                        }
                        @if (item.IsPayed == true)
                        {
                            <td class="text-success">
                                پرداخت شده
                            </td>
                        }
                        else
                        {
                            <td class="text-warning">
                                در انتظار پرداخت
                            </td>
                        }
                        <td>
                            <span data-placement="top" data-toggle="tooltip" title="" data-original-title="لغو سفارش">
                                <a onclick="Cancel(@item.Id)" data-toggle="modal" data-target="#modalSave" class="text-danger" uk-icon="close-circle-outline"></a>
                            </span>
                            <span data-placement="top" data-toggle="tooltip" title="" data-original-title="جزئیات سفارش">
                                <a onclick="Info(@item.Id)" data-toggle="modal" data-target="#modalSave" class="text-primary" uk-icon="information-circle-outline"></a>
                            </span>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="card-footer bg-white">
    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-end">

            @if (ViewBag.PageId == 1)
            {
                <li class="page-item d-none">
                    <a class="page-link" onclick="Page(@((int)ViewBag.PageId-1))">قبلی</a>
                </li>
            }
            else
            {
                <li class="page-item">
                    <a class="page-link" href="/Admin/Order?PageId=@((int)ViewBag.PageId-1)&ID=@ViewBag.ID&PhoneNumber=@ViewBag.phoneNumber&Status=@ViewBag.Status&InPageCount=@ViewBag.InPageCount">قبلی</a>
                </li>

            }

            <li class="page-item">
                <select id="pageNumber" class="custom-select custom-select-sm">
                    @for (int i = 1; i <= (ViewBag.PageCount + 1); i++)
                    {
                        <option class="page-item" value="@i" @(((int)ViewBag.pageId == i) ? "selected" : "" )>صفحه @i از @((int)ViewBag.PageCount + 1)</option>
                    }
                </select>
            </li>


            @if ((int)ViewBag.PageId > (int)ViewBag.PageCount)
            {
                <li class="page-item d-none">
                    <a class="page-link" onclick="Page(@((int)ViewBag.PageId + 1))">بعدی</a>
                </li>
            }
            else

            {
                <li class="page-item">
                    <a class="page-link" href="/Admin/Order?PageId=@((int)ViewBag.PageId+1)&ID=@ViewBag.ID&PhoneNumber=@ViewBag.phoneNumber&Status=@ViewBag.Status&InPageCount=@ViewBag.InPageCount">بعدی</a>
                </li>

            }
            <li>
                <select id="InPageCount" class="custom-select custom-select-sm">
                    @if (ViewBag.InPageCount == 0)
                    {
                        <option value="0" selected>10 در هر صفحه</option>
                        <option value="20">20 در هر صفحه</option>
                        <option value="30">30 در هر صفحه</option>
                        <option value="40">40 در هر صفحه</option>

                    }

                    @if (ViewBag.InPageCount == 20)
                    {
                        <option value="0">10 در هر صفحه</option>
                        <option value="20" selected>20 در هر صفحه</option>
                        <option value="30">30 در هر صفحه</option>
                        <option value="40">40 در هر صفحه</option>

                    }
                    else if (ViewBag.InPageCount == 30)
                    {
                        <option value="0">10 در هر صفحه</option>
                        <option value="20">20 در هر صفحه</option>
                        <option value="30" selected>30 در هر صفحه</option>
                        <option value="40">40 در هر صفحه</option>

                    }
                    else if (ViewBag.InPageCount == 40)
                    {
                        <option value="0">10 در هر صفحه</option>
                        <option value="20">20 در هر صفحه</option>
                        <option value="30">30 در هر صفحه</option>
                        <option value="40" selected>40 در هر صفحه</option>
                    }


                </select>
            </li>
        </ul>
    </nav>
</div>